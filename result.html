<!DOCTYPE html>
<html>
<head>
  <!-- Site made with Mobirise Website Builder v3.12.1, https://mobirise.com -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Mobirise v3.12.1, mobirise.com">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon">
  <meta name="description" content="Web Site Creator Description">
  <title>流浪狗GO Back Home</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic&amp;subset=latin">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i">
  <link rel="stylesheet" href="assets/bootstrap-material-design-font/css/material.css">
  <link rel="stylesheet" href="assets/et-line-font-plugin/style.css">
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
  <link rel="stylesheet" href="assets/tether/tether.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/animate.css/animate.min.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="stylesheet" href="assets/mobirise-gallery/style.css">
  <link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">
  <script src="assets/web/assets/jquery/jquery.min.js"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/6.6.8/sweetalert2.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/6.6.8/sweetalert2.js"></script>

  <script type="text/javascript">
    $(document).ready(function(){

    });

  </script>


</head>
<body>
<section id="menu-3l">

    <nav class="navbar navbar-dropdown bg-color transparent navbar-fixed-top">
        <div class="container">

            <div class="mbr-table">
                <div class="mbr-table-cell">

                    <div class="navbar-brand">
                        <a href="index.html" class="mbri-smile-face mbr-iconfont mbr-iconfont-menu navbar-logo" style="color: rgb(0, 0, 0);"></a>
                        <a class="navbar-caption text-black" href="index.html">流浪GO(狗)back home</a>
                    </div>

                </div>
                <div class="mbr-table-cell">

                    <button class="navbar-toggler pull-xs-right hidden-md-up" type="button" data-toggle="collapse" data-target="#exCollapsingNavbar">
                        <div class="hamburger-icon"></div>
                    </button>

                    <ul class="nav-dropdown collapse pull-xs-right nav navbar-nav navbar-toggleable-sm" id="exCollapsingNavbar"><li class="nav-item"><a class="nav-link link" href="index.html">首頁</a></li><li class="nav-item dropdown"><a class="nav-link link dropdown-toggle" href="artical.html" data-toggle="dropdown-submenu" aria-expanded="false">最新資訊</a><div class="dropdown-menu"><a class="dropdown-item" href="artical.html">文章列表</a><a class="dropdown-item" href="index.html#header3-1z">照顧資訊</a></div></li><li class="nav-item"><a class="nav-link link" href="about.html">關於我們</a></li><li class="nav-item nav-btn"><a class="nav-link btn btn-black-outline btn-black" href="index.html#header1-1y"><span class="mbri-hearth mbr-iconfont mbr-iconfont-btn" style="color: rgb(226, 80, 65);"></span>領養捷徑</a></li></ul>
                    <button hidden="" class="navbar-toggler navbar-close" type="button" data-toggle="collapse" data-target="#exCollapsingNavbar">
                        <div class="close-icon"></div>
                    </button>

                </div>
            </div>

        </div>
    </nav>

</section>

<section class="engine"><a rel="external" href="https://mobirise.com">mobirise.com</a></section><section class="mbr-section article mbr-parallax-background mbr-after-navbar" id="msg-box8-3s" style="background-image: url(assets/images/desert.jpg); padding-top: 120px; padding-bottom: 120px;">

    <div class="mbr-overlay" style="opacity: 0.5; background-color: rgb(34, 34, 34);">
    </div>
    <div class="container">
        <div class="row">
            <div class="col-md-8 col-md-offset-2 text-xs-center">
                <h3 class="mbr-section-title display-2">Result</h3>
                <div class="lead"><p>From 台灣最新的動物認領養開放資料 (節錄部份)</p></div>

            </div>
        </div>
    </div>

</section>

<section class="mbr-gallery mbr-section mbr-section-nopadding mbr-slider-carousel" id="gallery4-3t" data-filter="true" style="padding-top: 1.5rem; padding-bottom: 1.5rem;">

    <!-- Gallery -->
    <div class="mbr-gallery-row container">
        <div class=" mbr-gallery-layout-default">
            <div>
                <div id="result_table">


                </div>
            </div>
            <div class="clearfix"></div>
        </div>
    </div>

</section>




  <script src="assets/tether/tether.min.js"></script>
  <script src="assets/bootstrap/js/bootstrap.min.js"></script>
  <script src="assets/smooth-scroll/smooth-scroll.js"></script>
  <script src="assets/dropdown/js/script.min.js"></script>
  <script src="assets/touch-swipe/jquery.touch-swipe.min.js"></script>
  <script src="assets/viewport-checker/jquery.viewportchecker.js"></script>
  <script src="assets/jarallax/jarallax.js"></script>
  <script src="assets/masonry/masonry.pkgd.min.js"></script>
  <script src="assets/imagesloaded/imagesloaded.pkgd.min.js"></script>
  <script src="assets/bootstrap-carousel-swipe/bootstrap-carousel-swipe.js"></script>
  <script src="assets/theme/js/script.js"></script>
  <script src="assets/mobirise-gallery/player.min.js"></script>
  <script src="assets/mobirise-gallery/script.js"></script>


  <input name="animation" type="hidden">

    <script type="text/javascript">
          var result = {};
          var img_err = 0;
          function imgError(index){
              $('#res_'+index).hide();
              img_err++;

          }
          (function () {
              var paras = window.location.search.substring(1);
              paras.split("&").forEach(function(part) {
                var item = part.split("=");
                result[item[0]] = decodeURIComponent(item[1]);
              });
          })();

          var APIURL = 'https://raw.githubusercontent.com/106-NCHU-MIS-Project/mobirise/gh-pages/json/top20_'+result.animal_kind+'.json';
          var xhr = new XMLHttpRequest();
          xhr.open("GET", APIURL, true);
          // xhr.setRequestHeader();
    function getInfo(animal_id)
    {
        $.ajax({
            url: APIURL,
            data: {},
            type: "GET",
            dataType: "json",
            success: function(data,textStatus,jqXHR) {
              $.each(data, function(index,obj){
                  if (obj.animal_id == animal_id)
                  {
                      if (obj.animal_sex == 'M') {
                        obj.animal_sex = '公';
                      }
                      else if (obj.animal_sex == 'F') {
                        obj.animal_sex = '母';
                      }
                      else {
                        obj.animal_sex = '未輸入';
                      }
                      if (obj.animal_age == 'CHILD') {
                        obj.animal_age = '幼年';
                      }
                      else if (obj.animal_age == 'ADULT') {
                        obj.animal_age = '成年';
                      }
                      else {
                        obj.animal_age = '未輸入';
                      }

                      if (obj.animal_bodytype == 'MINI') {
                        obj.animal_bodytype = '迷你';
                      }
                      else if (obj.animal_bodytype == 'SMALL') {
                        obj.animal_bodytype = '小型';
                      }
                      else if (obj.animal_bodytype == 'MEDIUM') {
                        obj.animal_bodytype = '中型';
                      }
                      else if (obj.animal_bodytype == 'BIG') {
                        obj.animal_bodytype = '大型';
                      }
                      else {
                        obj.animal_bodytype = '未輸入';
                      }

                      if (obj.animal_sterilization == 'T') {
                        obj.animal_sterilization = '是';
                      }
                      else if (obj.animal_sterilization == 'F') {
                        obj.animal_sterilization = '否';
                      }
                      else {
                        obj.animal_sterilization = '未輸入';
                      }

                      if (obj.animal_bacterin == 'T') {
                        obj.animal_bacterin = '是';
                      }
                      else if (obj.animal_bacterin == 'F') {
                        obj.animal_bacterin = '否';
                      }
                      else {
                        obj.animal_bacterin = '未輸入';
                      }

                      if (obj.animal_status == 'NONE') {
                        obj.animal_status = '未公告';
                      }
                      else if (obj.animal_status == 'OPEN') {
                        obj.animal_status = '開放認養';
                      }
                      else if (obj.animal_status == 'ADOPTED') {
                        obj.animal_status = '已認養';
                      }
                      else if (obj.animal_status == 'OTHER') {
                        obj.animal_status = '其他';
                      }
                      else if (obj.animal_status == 'DEAD') {
                        obj.animal_status = '死亡';
                      }

                      if (obj.shelter_address == '') {
                        obj.shelter_address = '未輸入';
                      }
                      if (obj.shelter_tel == '') {
                        obj.shelter_tel = '未輸入';
                      }
                      if (obj.shelter_name == '') {
                        obj.shelter_name = '未輸入';
                      }
                      swal({
                        // title: 'Test', 
                        type: 'info', 
                        html: '<img src="'+obj.album_file+'" width=60% height=60%><ul style="text-align:left">'+
                              '<li>動物性別 ： '+obj.animal_sex+'</li>'+
                              '<li>動物年紀 ： '+obj.animal_age+'</li>'+
                              '<li>動物體型 ： '+obj.animal_bodytype+'</li>'+
                              '<li>動物毛色 ： '+obj.animal_colour+'</li>'+
                              '<li>是否絕育 ： '+obj.animal_sterilization+'</li>'+
                              '<li>是否施打狂犬病疫苗 ： '+obj.animal_bacterin+'</li>'+
                              '<li>動物狀態 ： '+obj.animal_status+'</li>'+
                              '<li>收容所名稱 ： '+obj.shelter_name+'</li>'+
                              '<li>收容所地址 ： '+obj.shelter_address+'</li>'+
                              '<li>聯絡電話 ： '+obj.shelter_tel+'</li>'

                      })
                  }
              });
              // console.log(data);
            },
            error: function() {
              console.log(error);
            },
            // complete: function() {
            //   
            // }            
        });
    }
          xhr.send();
          xhr.onreadystatechange = function(){
            if (this.readyState === 4 && this.status === 200){
              var data = JSON.parse(this.responseText);

              // console.log(data);
              var res_str = "";
              var res_count = 0;
              var ci_content = "";
              $.each(data, function(index,obj){
                if (result.animal_bodytype == '') {
                  
                }
                else if (obj.animal_bodytype != result.animal_bodytype) {
                  return;
                }
                if (result.animal_colour == '') {
                  
                }
                else if (obj.animal_colour != result.animal_colour) {
                  return;
                }
                if (result.animal_age == '') {

                }
                else if (obj.animal_age != result.animal_age) {
                  return;
                }
                // $('body').text(obj.animal_kind+obj.animal_sex);
                res_str += '<div id="res_'+index+'" class="mbr-gallery-item mbr-gallery-item__mobirise3 mbr-gallery-item--p1" data-tags="" data-video-url="false" onclick="javascript:getInfo('+obj.animal_id+')">';
                res_str += '<div href="#lb-gallery4-3t" data-slide-to="'+index+'" data-toggle="modal" >';
                res_str += '<img alt="" width=180px height=180px src="'+obj.album_file+'" onerror="imgError('+index+');" >';
                res_str += '<span class="icon-focus"></span>';
                if (obj.animal_foundplace.length > 4)
                {
                  var tmp = '';
                  obj.animal_foundplace = obj.animal_foundplace.split("", 3);
                  if (obj.animal_foundplace[2] == '市' || obj.animal_foundplace[2] == '區' || obj.animal_foundplace[2] == '鎮' || obj.animal_foundplace[2] == '鄉' || obj.animal_foundplace[3] == '之')
                  {
                    for (var i = 0; i < obj.animal_foundplace.length; i++) {
                      tmp += obj.animal_foundplace[i];
                    }
                    obj.animal_foundplace = tmp;
                  }
                  else
                  {
                      obj.animal_foundplace = '台灣的某地';
                  }
                }
                else if (obj.animal_foundplace.length > 0 && obj.animal_foundplace.length < 4) {
                  var tmp = "";
                  for (var i = 0; i < obj.animal_foundplace.length; i++) {
                    tmp += obj.animal_foundplace[i];
                  }
                  obj.animal_foundplace = tmp;
                }
                if (obj.animal_foundplace == "")
                  obj.animal_foundplace = '台灣的某地';
                res_str += '<span class="mbr-gallery-title" >'+obj.animal_kind+obj.animal_kind+'Found@'+obj.animal_foundplace+'</span></div></div>';
                res_count++;

              });

              if (res_count == 0) {
                  swal('目前沒有符合條件的浪浪', '何不看看我們為您精心挑選的浪浪？', 'error'); 

                  $.each(data, function(index,pick){
                res_str += '<div id="res_'+index+'" class="mbr-gallery-item mbr-gallery-item__mobirise3 mbr-gallery-item--p1" data-tags="" data-video-url="false" onclick="javascript:getInfo('+pick.animal_id+')">';
                res_str += '<div href="#lb-gallery4-3t" data-slide-to="'+index+'" data-toggle="modal" >';
                res_str += '<img alt="" width=180px height=180px src="'+pick.album_file+'" onerror="imgError('+index+');" >';
                res_str += '<span class="icon-focus"></span>';
                if (pick.animal_foundplace.length > 4)
                {
                  var tmp = '';
                  pick.animal_foundplace = pick.animal_foundplace.split("", 3);
                  if (pick.animal_foundplace[2] == '市' || pick.animal_foundplace[2] == '區' || pick.animal_foundplace[2] == '鎮' || pick.animal_foundplace[2] == '鄉' || pick.animal_foundplace[3] == '之')
                  {
                    for (var i = 0; i < pick.animal_foundplace.length; i++) {
                      tmp += pick.animal_foundplace[i];
                    }
                    pick.animal_foundplace = tmp;
                  }
                  else
                  {
                      pick.animal_foundplace = '台灣的某地';
                  }
                }
                else if (pick.animal_foundplace.length > 0 && pick.animal_foundplace.length < 4) {
                  var tmp = "";
                  for (var i = 0; i < pick.animal_foundplace.length; i++) {
                    tmp += pick.animal_foundplace[i];
                  }
                  pick.animal_foundplace = tmp;
                }
                if (pick.animal_foundplace == "")
                  pick.animal_foundplace = '台灣的某地';
                res_str += '<span class="mbr-gallery-title" >'+pick.animal_kind+pick.animal_kind+'Found@'+pick.animal_foundplace+'</span></div></div>';
                       
                  });
              
              }
              else {
                // alert(img_err);
                setTimeout(function(){
                  res_count = res_count - img_err;
                  swal(
                        '搜尋完成',
                        '總共為您尋到'+res_count+'隻浪浪',
                        'success',
                      )
                }, 300);
              }

              var home_btn = "";
              home_btn += '<section class="mbr-section article" id="msg-box3-3u" style="background-color: rgb(255, 255, 255); padding-top: 40px; padding-bottom: 40px;">';
              home_btn += '<div class="container">';
              home_btn += '<div class="row">';
              home_btn += '<div class="col-md-8 col-md-offset-2 text-xs-center">';
              home_btn += '<div><a class="btn btn-secondary" href="./filter.html">上一頁<br></a></div></div></div></div></section>';
              res_str += home_btn;
              res_str += '<footer class="mbr-small-footer mbr-section mbr-section-nopadding" id="footer1-2b" style="background-color: rgb(50, 50, 50); padding-top: 0.875rem; padding-bottom: 0.875rem;">';
              res_str += '<div class="container">';
              res_str += '<p class="text-xs-center">Copyright (c) 2017 NCHU-MIS.</p></div></footer>';
              $('#result_table').html(res_str);

  
            }
          }

    </script>

  </body>
</html>
